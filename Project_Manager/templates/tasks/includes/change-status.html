
{% load task_url %}
    

<div class="dropdown" id="status-{{ task.pk }}">
    <div tabindex="0" role="button" class="px-3 py-1 rounded-lg {{ task.status.color.bg_color }} text-sm font-medium {{ task.status.color.text_color }} border {{ task.status.color.border_color }}">
        {{ task.status }}
        <i class="fas fa-angle-down ml-1 mt-1"></i>
    </div>
    <ul tabindex="0" class="dropdown-content menu text-gray-600 bg-white border border-gray-300 rounded-box z-[1] w-60 p-2 shadow-sm">
        {% for status in statuses %}
        <li id="status-{{status.is_completed}}" onclick="logs(this);">
            <a class="flex items-center justify-between"
               hx-post="{% url_task task 'change_status' %}"
               hx-vals='{"status_id": "{{ status.pk }}"}'
               hx-target="#status-{{ task.pk }}"
            >
                <div class="flex items-center gap-2">
                    <span class="w-2.5 h-2.5 rounded-full bg-{{ status.color.color_name }}-500"></span>
                    {{ status }}
                </div>
                {% if task.status.pk == status.pk %}
                    <i class="fas fa-check text-green-500 text-sm"></i>
                {% endif %}
            </a>
        </li>
        {% endfor %}
        <li>
            <a onclick="modal_create_status.showModal();" class="flex items-center gap-2 text-sky-500 text-[0.95rem]">
                <span class="font-bold text-base">+</span>
                Добавить новый статус
            </a>
        </li>
    </ul>
</div>

<script>

function logs(statusLi){
    const taskDiv = statusLi.closest('[id^="taskDiv-"]');
    const titleTask = taskDiv.querySelector('h3[id^="titleTask-"]');
    const tagList = taskDiv.querySelector('[id^="tagList-"]');
    const avatar = taskDiv.querySelector('[id^="avatar-"]');
    const exAvatar = taskDiv.querySelector('[id^="exAvatar-"]');
    const priority = taskDiv.querySelector('[id^="priority-"]');
    
    

    if (statusLi.id == 'status-True') {
        titleTask.classList.add('line-through', 'text-gray-500');
        avatar.classList.add('grayscale');
        tagList.classList.add('grayscale');
        exAvatar.classList.add('grayscale');
        priority.classList.add('grayscale');
    } else if (statusLi.id == 'status-False') {
        titleTask.classList.remove('line-through', 'text-gray-500');
        avatar.classList.remove('grayscale');
        tagList.classList.remove('grayscale');
        exAvatar.classList.remove('grayscale');
        priority.classList.remove('grayscale');
    }
}


</script>